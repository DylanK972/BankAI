<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#0b0d14" />
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="assets/icon-192.png" />
  <title>BankIA ‚Äî D√©mo Web</title>
</head>
<body>
  <noscript>Cette d√©mo n√©cessite JavaScript.</noscript>

  <div class="container">
    <!-- Barre de marque (collante via CSS plus tard) -->
    <header>
      <div class="brand" aria-label="Identit√© produit">
        <img src="assets/icon-192.png" alt="Logo BankIA" />
        <h1>BankIA</h1>
        <span class="tag">D√âMO WEB</span>
      </div>
      <div class="row" aria-label="Actions globales">
        <span class="pill">localStorage ‚Äî gratuit</span>
        <button id="installBtn" class="btn ghost" aria-label="Installer l'app en PWA">Installer (PWA)</button>
      </div>
    </header>

    <!-- Bloc d√©mo / login / cl√© API ‚Äî MASQU√â mais conserv√© pour app.js -->
    <section class="card dev-hidden" id="demoBlock" aria-hidden="true">
      <div class="row" style="justify-content:space-between;align-items:center;gap:12px">
        <div class="row" style="align-items:center;gap:8px">
          <!-- doublon mois (cach√©), le vrai #monthTag visible est dans la carte Transactions -->
          <span class="pill">Mois <b id="monthTag" style="margin-left:6px;color:#fff"></b></span>
        </div>
        <div class="row">
          <select id="aiMode" class="btn" aria-label="Mode IA">
            <option value="demo" selected>D√©mo IA (gratuit, local)</option>
            <option value="api">Cl√© API (optionnel)</option>
          </select>
          <input id="apiKey" placeholder="Cl√© API (optionnel)" style="display:none;min-width:240px" autocomplete="off" />
        </div>
      </div>
      <div class="row" style="margin-top:10px">
        <input id="email" placeholder="Email (d√©mo)" autocomplete="email" />
        <input id="name" placeholder="Nom" autocomplete="name" />
        <button class="btn primary" id="loginBtn">Entrer</button>
        <button class="btn" id="logoutBtn">Sortir</button>
      </div>
      <p class="small" style="margin-top:8px">‚ö†Ô∏è D√©mo uniquement : tes donn√©es restent en local sur ton appareil.</p>
    </section>

    <main class="grid" role="main">
      <!-- COMPTE & MOUVEMENTS -->
      <section class="card card-hover" aria-labelledby="section-transactions">
        <header class="row" style="justify-content:space-between;align-items:center;margin-bottom:8px">
          <div class="row" style="align-items:center;gap:10px">
            <h2 id="section-transactions">Comptes & Transactions</h2>
          </div>
          <!-- mois dynamique pour l‚Äôutilisateur -->
          <span class="pill" id="monthTagVisible" aria-live="polite" aria-atomic="true">
            <!-- app.js remplit #monthTag ; on copie sa valeur dans CSS/JS si besoin.
                 Si tu veux la m√™me source, remplace l‚Äôid ici par id="monthTag" et retire
                 celui du bloc masqu√©. -->
          </span>
        </header>

        <!-- Solde global -->
        <div class="balance" id="balanceView" aria-label="Solde global">‚Ç¨0.00</div>

        <!-- KPIs mensuels -->
        <div class="kpi" role="region" aria-label="Indicateurs du mois">
          <div class="box" role="group" aria-label="D√©penses du mois">
            <div class="small">D√©penses du mois</div>
            <div id="spendMonth" class="kpi-value" aria-live="polite">‚Ç¨0</div>
          </div>
          <div class="box" role="group" aria-label="Revenus du mois">
            <div class="small">Revenus du mois</div>
            <div id="incomeMonth" class="kpi-value" aria-live="polite">‚Ç¨0</div>
          </div>
          <div class="box" role="group" aria-label="Cat√©gorie la plus d√©pens√©e">
            <div class="small">Top cat√©gorie</div>
            <div id="topCat" class="kpi-value" aria-live="polite">‚Äì</div>
          </div>
        </div>

        <!-- Historique des mouvements -->
        <ul class="list" id="txList" aria-label="Historique des transactions"></ul>

        <!-- Contr√¥les manuels masqu√©s (pr√©serv√©s pour app.js, ex. prototypage) -->
        <div class="row dev-hidden" style="margin-top:8px" aria-hidden="true">
          <input id="txLabel" placeholder="Libell√© (ex: Carrefour)" />
          <input id="txAmount" type="number" step="0.01" placeholder="Montant (+/-)" inputmode="decimal" />
          <select id="txCat" aria-label="Cat√©gorie">
            <option>Courses</option><option>Sorties</option><option>Transport</option>
            <option>Loyer</option><option>Abonnements</option><option>Autres</option>
          </select>
          <button class="btn primary" id="addTx">Ajouter</button>
          <button class="btn" id="resetData">R√©initialiser</button>
        </div>
        <div class="row dev-hidden" style="margin-top:6px" aria-hidden="true">
          <button class="btn ghost" id="exportBtn">Exporter JSON</button>
          <input type="file" id="importFile" style="display:none" accept="application/json" />
          <button class="btn ghost" id="importBtn">Importer JSON</button>
        </div>
      </section>

      <!-- ASSISTANT FINANCIER -->
      <section class="card card-hover" aria-labelledby="section-assistant">
        <header class="row" style="justify-content:space-between;align-items:center;margin-bottom:8px">
          <!-- Nom dynamique du bot (maj via updatePersonaTitle()) -->
          <h2 id="coachTitle">Coach IA</h2>
          <span class="small">Assistant financier personnel</span>
        </header>

        <div class="chat" aria-label="Chat avec l‚Äôassistant">
          <!-- zone de messages (aria-live pour annoncer les nouvelles r√©ponses) -->
          <div class="chat-box" id="chatBox" role="log" aria-live="polite" aria-relevant="additions"></div>

          <!-- Champ + bouton en premi√®re ligne -->
          <div class="foot" data-dock="true">
            <label for="chatInput" class="sr-only">Votre message</label>
            <input id="chatInput"
                   placeholder="Pose ta question : budgets, abonnements, safe-to-spend‚Ä¶"
                   style="flex:1"
                   autocomplete="off" />
            <button class="btn primary" id="sendChat" aria-label="Envoyer le message">Envoyer</button>
            <!-- ‚ö†Ô∏è app.js ajoutera ici les boutons dock: üé® Personnalise-moi & üí∂ Revenu -->
          </div>

          <!-- Barre d‚Äôactivit√© -->
          <div class="progress" aria-hidden="true"><i id="thinkingBar"></i></div>
          <div class="small" id="warn" style="opacity:.85" aria-live="polite"></div>
        </div>
      </section>
    </main>

    <!-- BUDGETS -->
    <section class="card card-hover" style="margin-top:14px" aria-labelledby="section-budgets">
      <header class="row" style="justify-content:space-between;align-items:center;margin-bottom:8px">
        <h2 id="section-budgets">Budgets</h2>
        <span class="small">Objectifs mensuels par cat√©gorie</span>
      </header>
      <div class="bud-row" id="budgets" role="region" aria-label="Budgets par cat√©gorie"></div>
    </section>

    <footer>¬© 2025 BankIA ‚Äî Cr√©√© par Dylan Kessler & Ricardo Caupenne / Version de test en local</footer>
  </div>

  <script src="app.js"></script>

  <!-- Helper accessible (classe utilitaire invisible pour lecteurs d‚Äô√©cran, √† styliser dans le CSS) -->
  <span class="sr-only" aria-hidden="true" style="position:absolute;width:1px;height:1px;overflow:hidden;clip:rect(1px,1px,1px,1px);white-space:nowrap;">.</span>

  <script>
    /* petite sync pour afficher aussi le mois dans le badge visible (#monthTagVisible)
       sans toucher √† app.js. On copie le texte mis dans #monthTag si pr√©sent. */
    document.addEventListener('DOMContentLoaded', () => {
      const hiddenTag = document.querySelector('#demoBlock #monthTag');
      const visibleTag = document.getElementById('monthTagVisible');
      if (hiddenTag && visibleTag) {
        const sync = () => { visibleTag.textContent = hiddenTag.textContent || ''; };
        // premi√®re sync + resync l√©g√®re apr√®s init()
        setTimeout(sync, 0);
        setTimeout(sync, 50);
        setTimeout(sync, 200);
      }
    });
  </script>
</body>
</html>
